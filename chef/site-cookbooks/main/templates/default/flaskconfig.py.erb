# Generated by Chef, do not edit

<% skeleton = node[:skeleton] -%>
<% db = node[:skeleton][:db] -%>
<% email = node[:skeleton][:email] -%>

from os.path import abspath, dirname
from config.common import config

flaskconfig = {
    'DEBUG': True,
    'BASE_DIR': abspath(dirname(__file__)),
    'SQLALCHEMY_DATABASE_URI': 'postgres://<%= db[:user]%>:<%=db[:password]%>@<%=db[:host]%>/<%=db[:database]%>',

    'host' : '0.0.0.0',

    'domain': '<%= skeleton[:server_names][0] %>',
    'port': <%= skeleton[:flask_port] %>,
    'email': {
        'admin': '<%= email[:admin] %>',
        'sender': '<%= email[:sender] %>',
        'server': 'localhost',
    },

    'default': 'home',
    'defaultRoles': ('anon',),

    'roles' : {
        'anon' : {
            'access' : {
                'home' : 'allow',
            },
        },
        'admin' : {
            'access' : {},
            'default': 'allow'
        }
    },

    'debug': <%= node[:skeleton][:debug] ? "True" : "False" %>,
    'MAIL_DEBUG': <%= email[:debug] ? "True" : "False" %>,
    'MAIL_SERVER': 'localhost',
    'MAIL_DEFAULT_SENDER': ('<%= email[:sender_name] %>', '<%= email[:sender] %>'),
}

from core.utils import update_configuration
update_configuration(config, flaskconfig)
